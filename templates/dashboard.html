{% extends "base.html" %}

{% block title %}Dashboard - Task Manager{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="me-2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
            <line x1="9" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2"/>
            <line x1="15" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2"/>
            <line x1="3" y1="9" x2="21" y2="9" stroke="currentColor" stroke-width="2"/>
        </svg>
        Dashboard
    </h1>
    <a href="{{ url_for('create_task') }}" class="btn btn-primary">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="me-1">
            <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        New Task
    </a>
</div>

<!-- Statistics Cards -->
<div class="row mb-4 fade-in">
    <div class="col-md-3 mb-3">
        <div class="card bg-primary text-white slide-up">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h5 class="card-title">Total Tasks</h5>
                        <h2 class="mb-0">{{ total_tasks }}</h2>
                    </div>
                    <div class="align-self-center">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="opacity-75">
                            <path d="M9 5H7C5.89543 5 5 5.89543 5 7V19C5 20.1046 5.89543 21 7 21H17C18.1046 21 19 20.1046 19 19V7C19 5.89543 18.1046 5 17 5H15M9 5C9 6.10457 9.89543 7 11 7H13C14.1046 7 15 6.1046 15 5M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 5" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-3 mb-3">
        <div class="card bg-success text-white slide-up">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h5 class="card-title">Completed</h5>
                        <h2 class="mb-0">{{ completed_tasks }}</h2>
                    </div>
                    <div class="align-self-center">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="opacity-75">
                            <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-3 mb-3">
        <div class="card bg-warning text-white slide-up">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h5 class="card-title">Pending</h5>
                        <h2 class="mb-0">{{ pending_tasks }}</h2>
                    </div>
                    <div class="align-self-center">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="opacity-75">
                            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                            <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-3 mb-3">
        <div class="card bg-danger text-white slide-up">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h5 class="card-title">Overdue</h5>
                        <h2 class="mb-0">{{ overdue_tasks }}</h2>
                    </div>
                    <div class="align-self-center">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="opacity-75">
                            <path d="M12 9V11M12 13V15M10.29 3.86L1.82 18C1.64681 18.3024 1.55399 18.6453 1.55279 18.9942C1.55159 19.3431 1.642 19.6868 1.81323 19.9905C1.98446 20.2941 2.23021 20.5465 2.52459 20.7239C2.81897 20.9013 3.15221 20.9972 3.5 21H20.5C20.8478 20.9972 21.181 20.9013 21.4754 20.7239C21.7698 20.5465 22.0155 20.2941 22.1868 19.9905C22.358 19.6868 22.4484 19.3431 22.4472 18.9942C22.446 18.6453 22.3532 18.3024 22.18 18L13.71 3.86C13.5317 3.56611 13.2807 3.32312 12.9812 3.15448C12.6817 2.98585 12.3438 2.89725 12 2.89725C11.6562 2.89725 11.3183 2.98585 11.0188 3.15448C10.7193 3.32312 10.4683 3.56611 10.29 3.86Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Recent Tasks -->
<div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="fas fa-history"></i> Recent Tasks</h5>
                <a href="{{ url_for('tasks') }}" class="btn btn-sm btn-outline-primary">View All</a>
            </div>
            <div class="card-body">
                {% if recent_tasks %}
                    <div class="list-group list-group-flush">
                        {% for task in recent_tasks %}
                            <div class="list-group-item d-flex justify-content-between align-items-start">
                                <div class="ms-2 me-auto">
                                    <div class="fw-bold">{{ task.title }}</div>
                                    <small class="text-muted">
                                        {% if task.created_at %}
                                            Created {{ task.created_at.strftime('%Y-%m-%d %H:%M') }}
                                        {% else %}
                                            Created recently
                                        {% endif %}
                                        {% if task.category %}
                                            | <span class="badge category-badge" data-color="{{ task.category.color }}">{{ task.category.name }}</span>
                                        {% endif %}
                                    </small>
                                </div>
                                <span class="badge bg-{{ task.status_color }} rounded-pill">{{ task.status.title() }}</span>
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="text-center py-4">
                        <i class="fas fa-tasks fa-3x text-muted mb-3"></i>
                        <h5 class="text-muted">No tasks yet</h5>
                        <p class="text-muted">Create your first task to get started!</p>
                        <a href="{{ url_for('create_task') }}" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Create Task
                        </a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-chart-pie"></i> Progress Overview</h5>
            </div>
            <div class="card-body">
                {% if total_tasks > 0 %}
                    <div class="mb-3">
                        <div class="mb-2">Completion Rate</div>
                        <div class="progress">
                            <progress class="progress-bar bg-success" max="100" 
                                 value="{{ (completed_tasks / total_tasks * 100)|round(1) }}">
                                {{ (completed_tasks / total_tasks * 100)|round(1) }}%
                            </progress>
                        </div>
                    </div>
                    
                    <div class="row text-center">
                        <div class="col-6">
                            <div class="border-end">
                                <h4 class="text-info">{{ in_progress_tasks }}</h4>
                                <small class="text-muted">In Progress</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <h4 class="text-danger">{{ overdue_tasks }}</h4>
                            <small class="text-muted">Overdue</small>
                        </div>
                    </div>
                {% else %}
                    <div class="text-center">
                        <i class="fas fa-chart-pie fa-3x text-muted mb-3"></i>
                        <p class="text-muted">No data available yet</p>
                    </div>
                {% endif %}
            </div>
        </div>
        
        <div class="card mt-3">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-lightbulb"></i> Quick Actions</h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <a href="{{ url_for('create_task') }}" class="btn btn-outline-primary">
                        <i class="fas fa-plus"></i> Create Task
                    </a>
                    <a href="{{ url_for('tasks') }}?status=pending" class="btn btn-outline-warning">
                        <i class="fas fa-clock"></i> View Pending
                    </a>
                    <a href="{{ url_for('categories') }}" class="btn btn-outline-info">
                        <i class="fas fa-tags"></i> Manage Categories
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
